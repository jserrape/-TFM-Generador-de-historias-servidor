{% extends 'base.html' %}
{% block content %}
      <div class="container">
         <div class="col-md-12">
            <br><br><br><br>
            <h1 class="titulo">Nueva historia</h1>
            <hr>
            <form id="nueva-historia-form">
               <div class="form-group">
                  <label for="id">Nombre de la historia</label>
                  <input name="nombre_historia" type="text" class="form-control" value="" placeholder="Introduzca nombre de la historia" />
               </div>
               <div class="form-group">
                  <label for="id">Imagen de título</label>
                  <input name="imagen_historia" type="text" class="form-control" value="" placeholder="Añada imagen de título" />
               </div>
               <div class="form-group">
                  <label for="id">Latitud inicial</label>
                  <input name="latitud_historia" type="number" step="0.0001" class="form-control" value="37.197" placeholder="Introduzca la latitud inicial" />
               </div>
               <div class="form-group">
                  <label for="id">Longitud inicial</label>
                  <input name="longitud_historia" type="number" step="0.0001" class="form-control" value="-3.62" placeholder="Introduzca la longitud inicial" />
               </div>
               <div class="form-group">
                  <label for="id">Zoom de la cámara</label>
                  <input name="zoom" type="text" class="form-control" value="" placeholder="Introduzca el zoom inicial" />
               </div>
               <div class="form-group">
                  <label for="id">Descripción de la historia</label>
                  <input name="descripcion_historia" type="text" class="form-control" value="" placeholder="Introduzca la descripción de la historia" />
               </div>

               <br>
               <hr>

               <div id="div_misiones">
               </div>

               <p id="desarrollador"></p>

               <div class="row">
                  <div class="col-md-12">
                    <div class="col-md-6">
                      <div class="form-group">
                         <input value="Nueva misión" class="btn btn-success" id="btn"/>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                         <input value="Crear historia" type="submit" class="btn btn-primary" />
                      </div>
                    </div>
                  </div>
               </div>
            </form>
         </div>
      </div>

   <script>
     var debug = true;
     var num = 1;
     if ( debug ){
       var HISTORIA_REST_URL = "http://localhost/rest/historia";
     }else{
       var HISTORIA_REST_URL = "https://tfm-historias.herokuapp.com/rest/historia";
     }

     $('.btn').on('click', function() {
       console.log("Hello world!");
       //$("#desarrollador").html("<b>Desarrollador:</b> " + "Hola mundo");
       //var element = document.getElementById("div_mision_1");
       //var child = document.getElementById("p1");
       //element.insertBefore(para, child);
       //document.getElementById('div_misiones').innerHTML = '<ol id="'+num+'"><li>html data '+num+'</li></ol>';

       //Div contenedor
       var para = document.createElement("div");
       para.setAttribute("id", "div_mision_"+num);
       var element = document.getElementById("div_misiones");
       element.appendChild(para);

       //Titulo mision
       document.getElementById("div_mision_"+num).innerHTML = '<h1>Misión #' + num + '</h1>';

       //Nombre de la mision
       document.getElementById("div_mision_"+num).innerHTML = document.getElementById("div_mision_"+num).innerHTML + '<div class="form-group"><label for="id">Nombre de la misión</label><input id="nombre_mision_' + num + '" name="nombre_mision_' + num + '" type="text" class="form-control" value="" placeholder="Introduzca nombre de la misión" /></div>';


       //Separacion final
       document.getElementById("div_mision_"+num).innerHTML = document.getElementById("div_mision_"+num).innerHTML + '<br><hr>';

       num= num + 1;
      });

     $(function POST_historia(){
      $('#nueva-historia-form').submit(function(){
        $.ajax({
          url: HISTORIA_REST_URL,
          type: 'POST',
          data: $('#nueva-historia-form').serialize(),
          success: function (){
            location.reload();
          },
          error: function (request, message, error){
            console.log("Error performing POST on " + HISTORIA_REST_URL);
          }
        });
        return false;
      });
    })
   </script>
 </body>
</html>
{% endblock %}
